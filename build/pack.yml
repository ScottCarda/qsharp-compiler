steps:

- task: NuGetCommand@2
  displayName: 'Pack Q# compiler'
  inputs:
    command: pack
    packagesToPack: >
      src\QsCompiler\Compiler\QsCompiler.csproj;
    versioningScheme: byEnvVar
    versionEnvVar: NUGET_VERSION
    packDestination: '$(System.DefaultWorkingDirectory)'
    includeReferencedProjects: true

- task: CmdLine@1
  displayName: 'Pack VS Code extension'
  inputs:
    filename: vsce
    arguments: package
    workingFolder: $(VSCodeExtensionSrcDir)

- task: MSBuild@1
  displayName: 'Pack Visual Studio extension'
  inputs:
    solution: '$(VSExtensionSrcDir)/../VisualStudioExtension.sln'
    configuration: '$(BuildConfiguration)'
    msbuildArguments: >
      /t:CreateVsixContainer 
      /p:AssemblyVersion=$(Assembly.Version)

- task: NuGetCommand@2
  displayName: 'Pack project templates'
  inputs:
    command: pack
    packagesToPack: >
      src\Nuspecs\Microsoft.Quantum.ProjectTemplates.nuspec;
    versioningScheme: byEnvVar
    versionEnvVar: NUGET_VERSION
    packDestination: '$(System.DefaultWorkingDirectory)'
    includeReferencedProjects: false
